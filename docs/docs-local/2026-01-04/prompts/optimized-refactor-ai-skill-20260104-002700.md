# RAPO Optimization Report

## Metadata

- **Date**: 2026-01-04
- **Time**: 00:27:00
- **Project**: /home/leonai-do/Host-D-Drive/LeonAI_DO/dev/Agent-Skills
- **Branch**: main
- **Base Prompt**: Nice, good catch, let's remove the proposal form this skill and let's create a new skill based on th...

---

## Analysis Summary

### Extracted Constraints

- **Separation of Concerns**: Separate AI logic from `sitemap_to_markdown`.
- **New Skill**: Create a new skill (e.g., `markdown-ai-enricher` or `ai_content_agent`) specifically for AI features (Summarization, Entity Extraction, Semantic Chunking).
- **Integration**: The new skill should be able to run standalone OR be invoked by `sitemap_to_markdown` (via CLI/subprocess or workflow) if AI flags are present.
- **Dependency**: The new skill depends on `pydantic-ai` and `tiktoken`. `sitemap_to_markdown` remains lightweight.
- **Workflow**: `sitemap_to_markdown` downloads content â†’ new skill enriches it.
- **Behavior Preservation**: Keep the same logic/goals (Summarization, Entity Extraction, Semantic Chunking) defined in the previous proposal, just moved to a new home.

### Architectural Patterns

- **Modular Composition**: Two distinct skills working in tandem (Unix philosophy).
- **Agentic Workflow**: One agent (crawler) feeds another agent (enricher).
- **Pydantic AI**: Continued use of Pydantic AI for the new skill's implementation.

### Coding Conventions

- **Python**: Existing stack.
- **OpenSpec**: Use OpenSpec for proposal/change management.
- **Skill Structure**: Standard `skills-repository/<skill_name>/` structure with `SKILL.md`.

### Known Pain Points

- **Bloated Crawler**: The user explicitly agreed with the "God Object" concern for `sitemap_to_markdown`.
- **Dependency Heaviness**: Pydantic AI dependencies should move to the new skill.

---

## Optimized Prompt

### Character:

You are a Senior Skill Architect responsible for refactoring a monolithic feature request into a modular, multi-skill architecture. You prioritize separation of concerns, reusability, and clean integration patterns.

### Request:

1.  **Refactor the current OpenSpec proposal** (`implement-pydantic-ai-features`) to target a **NEW SKILL** called `ai_content_enricher` (or `markdown_ai_enricher`) instead of modifying `sitemap_to_markdown`.
2.  **Delete/Archive** the previous proposal targeting `sitemap_to_markdown`.
3.  **Create a NEW Proposal** for `ai_content_enricher` that:
    - Defines the skill structure (`skills-repository/ai_content_enricher/`).
    - Implements the **same** AI features (Summarization, Entity Extraction, Semantic Chunking, Pydantic AI integration) as originally planned.
    - Defines inputs: A directory of markdown files or a specific file path.
    - Defines outputs: Updates frontmatter in-place, creates sidecar metadata files, or generates chunk files.
4.  **Define Integration Logic**:
    - Explain how `sitemap_to_markdown` will hand off data to this new skill (e.g., strictly as a downstream consumer in a workflow, or via a "trigger" flag that runs the new skill as a subprocess). _Constraint: The user wants deep integration where the crawler CAN call the AI skill if requested._
5.  **Output**: A fully validated OpenSpec proposal (`proposal.md`, `tasks.md`, `design.md`, `spec.md`) under a new change ID (e.g., `create-ai-content-enricher-skill`).

### Adjustment:

- **Do NOT** add `pydantic-ai` dependencies to `sitemap_to_markdown.py`.
- **Ensure** the new skill can run **standalone** on any markdown files (not just those from the sitemap crawler).
- **Keep** the exact same Pydantic AI implementation logic (Models, Agents, Chunking) but adapt it to the new skill's entry point.

### Type of Output:

Actionable steps to:

1.  Remove the old proposal.
2.  Create the new proposal directory and files.

### Extras:

- Review `skills-repository/sitemap_to_markdown/sitemap_to_markdown.py` briefly to ensure we strip any AI stubs if necessary (or leave them as placeholders for the subprocess call).

---

## Usage Instructions

1.  Execute `rm -rf openspec/changes/implement-pydantic-ai-features` to clear the old proposal.
2.  Create `openspec/changes/create-ai-content-enricher-skill`.
3.  Draft the new `proposal.md`, `design.md`, and `tasks.md` reflecting the new architecture.
4.  Validate the new proposal.

_Generated by RAPO on 2026-01-04_
